    import { Injectable } from "@angular/core";
    import { Observable, of, throwError } from "rxjs";
    import { delay, retry, catchError } from "rxjs/operators";
    import {HttpClient, HttpErrorResponse, HttpHeaders} from '@angular/common/http';
    
    import { Student } from "../models/student.model";
    
    
    @Injectable()
    export class StudentService{
            constructor(private _httpClient : HttpClient){}
       

            
            baseUri = "https://localhost:44368/api/Student";

            
            getStudents():  Observable<Student[]> {
          
                return  this._httpClient
                        .get<Student[]>(`${this.baseUri}`)
                        .pipe(
                            retry(1),
                            catchError(this.handleError)
                        );
            

                    }
    
    
            private handleError(errorResponse : HttpErrorResponse){
              if(errorResponse.error instanceof ErrorEvent){
                console.log("Hello from Client side error");
                console.log('Client side Error',
                  errorResponse.error.message
                )
              }
              else{
                console.log("Hello from Server error----------");
                console.log('Server side Error',
                  errorResponse
                )
              }
              return throwError("There is a problem with the service. We are notified & working on it. Please try again later.");
            }
    
            Data : Student = new Student();
          
            CreateStudent(studentObj : Student) : Observable<Student>{

                this.Data.id = studentObj.id;
                this.Data.name = studentObj.name;
  
              this.Data.email = studentObj.email;
              this.Data.dob = studentObj.dob;
              this.Data.gender = studentObj.gender;
              
    
    
    
                console.log("data which is passing to post method is"+this.Data);
                return this._httpClient

                .post<Student>(`${this.baseUri}`,this.Data,
                        {
                          headers: new HttpHeaders({
                            'Content-Type':'application/json'
                          })
                        }
                        )
                        .pipe(catchError(this.handleError));
    
            }
            updateStudent(studentObj : Student) : Observable<void>{

                this.Data.id = studentObj.id;
                this.Data.name = studentObj.name;
  
              this.Data.email = studentObj.email;
              this.Data.dob = studentObj.dob;
              this.Data.gender = studentObj.gender;
              
                console.log("data which is passing to post method is"+this.Data);
                return this._httpClient
                .put<void>(`${this.baseUri}/${studentObj.id}`,
                           this.Data,
                            {
                                headers: new HttpHeaders({
                                'Content-Type':'application/json'
                                })
                            }
 
                            )
                        .pipe(catchError(this.handleError));
            }
    


    
            GetStudentByID(ID:number) : Observable<Student>{
    
              return this._httpClient
              .get<Student>(`${this.baseUri}/${ID}`)
              .pipe(catchError(this.handleError));
            }
    
      
        DeleteStudent(id:number): Observable<void>{
    
          return this._httpClient.delete<void>(`${this.baseUri}/${id}`).pipe(
                  catchError(this.handleError)
                  );
    
        } 
    
    
      }
    